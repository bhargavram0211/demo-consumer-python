name: Security Scan - Secrets

on:
  pull_request:
    branches: ['*']
  push:
    branches: [main, master]

jobs:
  secret-scan:
    name: Scan for Secrets with Gitleaks
    # Replace YOUR-GITHUB-USERNAME with your actual GitHub username
    uses: bhargavram0211/sentinel-flow/.github/workflows/reusable-secrets.yml@dev-v1.0
    with:
      # Use pr-only mode for faster scans on pull requests
      gitleaks_mode: 'pr-only'
      
      # Fail the workflow if secrets are detected
      fail_on_findings: true
      
      # Upload results to GitHub Security tab
      upload_sarif: true
    permissions:
      contents: read
      security-events: write
      pull-requests: read
